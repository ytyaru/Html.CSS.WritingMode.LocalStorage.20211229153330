# 0.63 不要なファイル、関数、コメントアウトを削除した。

## 考察

1. ビューアのWebComponent化
2. ページ数表示パターン（通し番号。ノンブル。残り。割合％）
3. wring-modeに応じて変化するCSS論理プロパティまとめ（位置・サイズ）
4. `<br>`の使い方

### 1. ビューアのWebComponent化

```html
<book-viewer></book-viewer>
<book-viewer header="heading" footer="number"></book-viewer>
```

### 2. ページ数表示パターン（通し番号。ノンブル。残り。割合％）

<book-viewer></book-viewer>
<book-viewer header="heading" footer="number"></book-viewer>

### 3. wring-modeに応じて変化するCSS論理プロパティまとめ（位置・サイズ）

* https://coliss.com/articles/build-websites/operation/css/new-css-logical-properties.html

相対|horizontal-tb|vertical-rl
----|-------------|-----------
`block-size`|`height`|`width`
`inline-size`|`width`|`height`

相対|horizontal-tb|vertical-rl
----|-------------|-----------
`block-start`系|`top`系|`right`系
`block-end`系|`bottom`系|`left`系
`inline-start`系|`left`系|`top`系
`inline-end`系|`right`系|`bottom`系

　`padding`,`border`,`margin`のサイズに関してもこれに従う。

相対|horizontal-tb|vertical-rl
----|-------------|-----------
`padding-block-start`|`padding-top`|`padding-right`
`padding-block-end`|`padding-bottom`|`padding-left`
`padding-inline-start`|`padding-left`|`padding-top`
`padding-inline-end`|`padding-right`|`padding-bottom`

相対|horizontal-tb|vertical-rl
----|-------------|-----------
`border-block-start`|`border-top`|`border-right`
`border-block-end`|`border-bottom`|`border-left`
`border-inline-start`|`border-left`|`border-top`
`border-inline-end`|`border-right`|`border-bottom`

相対|horizontal-tb|vertical-rl
----|-------------|-----------
`margin-block-start`|`margin-top`|`margin-right`
`margin-block-end`|`margin-bottom`|`margin-left`
`margin-inline-start`|`margin-left`|`margin-top`
`margin-inline-end`|`margin-right`|`margin-bottom`

　位置に関しては以下の通り。

相対|horizontal-tb|vertical-rl
----|-------------|-----------
`inset-block-start`|`top`|`right`
`inset-block-end`|`bottom`|`left`
`inset-inline-start`|`left`|`top`
`inset-inline-end`|`right`|`bottom`

　けれどページめくり方向（左綴じ／右綴じ）などに関しては指定できない。

```css
--page-start: left/right;
--page-end: right/left;

--page-left;
--page-right:
--page-top:
--page-bottom:

--page-direction: left, right (horizontal-tb, vertical-rl)
--inset-page-start
--padding-page-start
--border-page-end
--margin-page-end

```

* ページめくり方向（左綴じ／右綴じ）
* ページ開始位置
* ページ終了位置
* 

### 4. `<br>`の使い方

```markdown
# 要素

要素|意味|MDN
----|----|---|
`<p>`|段落|[<p>][p]
`<br>`|改行|[<br>][br]

## `<p>`

```html
<p>要約文です。詳細文が続きます。こんなふうにね。</p>
```

　`<p>`はパラグラフ（段落）を表す。HTMLにおいて文章は[<p>][p]要素のテキストコンテントに書く。パラグラフ・ライティングによれば段落は要約文と詳細文に大別される。最初の文さえ読めば概要が把握できるように書く。複数の段落で構成された文章のとき、要約文だけを読めば概要が把握できるようになる。速読はそうして行われる。

## `<br>`

```html
<p>要約文です。<br>詳細文が続きます。<br>こんなふうにね。</p>
```

　`<br>`は改行を表す。HTMLにおいて改行コードは`<pre>`のテキストコンテント以外では無視される。もし特定の箇所で改行させたくば`<br>`を使うことになる。さもなくば普通は画面の端で自動的に折り返しされることになる。

# `<br>`の使い方について

* 複数回改行した分だけのスペースが欲しい
* 長すぎるから改行したい
* 短すぎるから改行したくない

## 複数回改行した分だけのスペースが欲しい

　`<br>`を連続で複数回使うのはNG。読み上げソフトの妨げになりアクセシビリティが下がるから。よって以下のようなコードはダメ。

```html
<p>一行目です。<br>二行目です。<br><br><br>三行目です。</p>
```

　でも複数行分の改行スペースは開けたい。そんなときはCSSを使う。`margin`よりも`line-height`を使うべき。つまり以下のようなコードが望ましい。

```html
<p>一行目です。<br>二行目です。<br height="3">三行目です。</p>
```
```css
br {
    line-height: calc(var(attr(height), 1) * 1em);
}
```

　ところが、以下コードを書いても１行分のスペースしか開かなかった。

```html
<style>br { line-height:2em; }</style>
<p>一行目です。<br>二行目です。<br height="3">三行目です。</p>
```
```html
<style>br { margin:2em; }</style>
<p>一行目です。<br>二行目です。<br height="3">三行目です。</p>
```
```html
<style>br { line-height: calc(var(attr(height), 1) * 1em); }</style>
<p>一行目です。<br>二行目です。<br height="3">三行目です。</p>
```
```html
<style>br { margin: calc(var(attr(height), 1) * 1em); }</style>
<p>一行目です。<br>二行目です。<br height="3">三行目です。</p>
```

　どうやら`<br>`要素にCSSを付与しても適用されないらしい。MDNではできると書いていたのに。仕方ないから`<p>`に`margin`を設定することで代用する。

```html
<style>p { margin-block-end: calc(var(--not-define, attr(height), 1) * 1em); }</style>
<p>一段落目です。その詳細文が続きます。</p>
<p>二段落目です。各段落の末尾には余白がつきます。</p>
<p height="3">三段落目です。余白サイズを変更するには<code>height</code>属性値にem単位の数値をセットしてください。ここでは3emの余白、つまり3行分の余白がつきます。</p>
<p>四段落目です。各段落の末尾には余白がつきます。画面下端でさえ付与されてしまいます。</p>
```

　動かない。どうやら`attr()`は`content`プロパティに値をセット刷るときにしか使えないらしい。

* https://stackoverflow.com/questions/46323117/using-html-data-attributes-as-css-variable-i-e-text-shadow

```html
<style>p.multi-line { margin-block-end: calc(var(--height, attr(integer height), 1) * 1em); }</style>
<p>一段落目です。その詳細文が続きます。</p>
<p>二段落目です。各段落の末尾には余白がつきます。</p>
<p class="multi-line" style="--height:3;">三段落目です。余白サイズを変更するには<code>height</code>属性値にem単位の数値をセットしてください。ここでは3emの余白、つまり3行分の余白がつきます。</p>
<p>四段落目です。各段落の末尾には余白がつきます。画面下端でさえ付与されてしまいます。</p>
```

　これでやっとできた。けれど冗長すぎる。こんなクソコードを手書きしていたら人生が終わる。ここまでやるなら以下のように直接書いたほうが早い。

```html
<p>一段落目です。その詳細文が続きます。</p>
<p>二段落目です。各段落の末尾には余白がつきます。</p>
<p style="margin-block-end:3em;">三段落目です。余白サイズを変更するには<code>height</code>属性値にem単位の数値をセットしてください。ここでは3emの余白、つまり3行分の余白がつきます。</p>
<p>四段落目です。各段落の末尾には余白がつきます。画面下端でさえ付与されてしまいます。</p>
```

　やはりHTML自体が冗長と言わざるを得ない。

　そもそも複数行の改行を許したら読みづらくなる。WEB小説ではわざとスペースを増やすこともある。字がつまりすぎている印象を薄めるために。けれどそんな姑息な見た目の小細工よりも、話題や焦点をはっきりさせて意味が理解しやすい文章を書くほうが大事。でも選択肢としては欲しい。

## 長すぎるから改行したい

　ふつう文章は長すぎると読みにくい。日本語は１行あたり40〜50字くらいが読みやすいとされている。そのため適当なところで改行するなり、本文全体の幅を小さくして自動折り返しさせるなどで誤魔化していた。

　新聞や論文では段組みして１行あたりの字数を調整していた。CSSでは段組み機能がなかったり、ブラウザ対応率が低いなどの問題がある。そのせいでいまだに改行が利用される。

　だが、改行は悪である。スマホなど解像度が大きく異なる環境では妙なところで改行が入ってしまい読みづらくなることがあるから。

　昨今、高解像度ディスプレイが普及してきた。16:9で1920x1080。かつて普及していた1024x768と比べると倍近い横幅だ。もしフォントサイズにしろ改行にしろ、それぞれのデバイスで１行あたり40〜50字にしたいが、そのように設定できるプロパティは存在しない。よって改行でごまかす手法を使う。だが、改行があるせいで解像度が大きく異なるデバイスでは読みづらくなってしまう。ジレンマである。

　正しい対処としては次の通りだ。

* １行あたり40〜50字になるようフォントサイズを画面サイズに応じて動的に計算してセットする
* `<br>`による改行は一切しない
* `<p>`にCSSで余白を設定する：`p {margin-block-end:1em;}`
* もしフォントサイズが大きすぎたら段組みして１画面あたりの表示字数を増やせるようにする

## 短すぎるから改行したくない

　長すぎるから改行したいの逆バージョン。

　サイズをスマホに合わせて改行していると、大型ディスプレイで見たときムダに改行が多すぎて読みづらくなる。

　つまるところ、レスポンシブ対応として先述のとおりにすべきである。

## 末尾の`<p>`には余白をつけたくない

　改行を使うのは悪手。よってCSSで`<p>`の余白をセットすることで段落間に余白があるように見せるよう実装すべきだとわかった。コードでいうと以下。

style.css
```css
p { margin-block-end:1em; }
```
index.html
```html
<p>要約文１。詳細文１。</p>
<p>要約文２。上の段落との間に余白があるはず。</p>
```

　ところが、上記の方法では問題がある。段組みやページの区切りにおいてその末尾にある`<p>`要素には余白をつけたくない場合がある。

style.css
```css
* {
    padding:0;
    margin:0;
}
body {
    column-count: 2;
}
p:not(:first-child) {
    break-before:column;
}
p {
    margin-block-end:1em;
}
```
index.html
```html
<p>要約文１。詳細文１。</p>
<p>要約文２。上の段落との間に余白があるはず。</p>
```

　すると各段落の末尾行に余白ができてしまう。

```
段組み１。｜段組み２。

```

```css
p:not(:last-child-of-column) {
    margin-block-end:1em;
}
```

* [疑似クラスと疑似要素](https://developer.mozilla.org/ja/docs/Learn/CSS/Building_blocks/Selectors/Pseudo-classes_and_pseudo-elements)

<a id="impressions"></a>
# [所感](#impressions)

　

[p]:https://developer.mozilla.org/ja/docs/Web/HTML/Element/p
[br]:https://developer.mozilla.org/ja/docs/Web/HTML/Element/br

<a id="target-environment"></a>
# [対象環境](#target-environment)

* <time datetime="2022-01-16T16:07:50+0900" title="実施日">2022-01-16</time>
```
