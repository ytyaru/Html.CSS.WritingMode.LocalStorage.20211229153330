# ページ遷移は縦書き＝右綴じ／横書き＝左綴じに対応するようにしたい

WritingMode|綴じ|方向
-----------|----|----
縦書き|右綴じ|N
横書き|左綴じ|Z

* https://note.com/writers_seizando/n/nab3ddb7823af

　右綴じは右開きともいう。向かって左側から右側へページをめくる本のこと。左綴じは左開きともいう。向かって右側から左側へページをめくる本のこと。

　今回はこれを踏襲したい。具体的にはマウスのカーソルを適切な位置で適切なアイコンに変更し、適切にページめくりしたい。

方向／媒体|このアプリ|本
----------|----------|--
縦書き|下から上へめくる|左から右へめくる
横書き|右から左へめくる|右から左へめくる

　本と一致していないのは縦書きのときだけ。

## 問題

　横書きのとき「横」ボタンを押すと縦書きになった直後、次のページへ遷移してしまう。原因は「横」ボタンの位置が次ページ遷移する領域だったからそのクリックイベントが発火したのだと思われる。同じように「縦」ボタンを押すと横書きになった直後、次のページへ遷移してしまう。

　もちろんボタン押下時は次ページ遷移クリックしないでほしい。

　どうやって実装するか。以下のようにクリックイベントを`window`から`body`に移す？　たぶん変わらないだろう。どうしたもんか。

```javascript
window.addEventListener('DOMContentLoaded', (event) => {
    document.body.addEventListener('click', (event) => {
        const IS_VERTICAL = ('vertical-rl' === document.querySelector('#writing-mode').value);
        movePagePositionalDevice(event.clientX);
});
```

## 解決案

* メニューのボタンを画面中央に寄せる（今後も意識せねばならない）
* ページ遷移用ボタンを新規作成してマウスオーバーしたときだけ現れるようにしそれをクリックしたときだけページ遷移させる（スマホなどタップするときは解決できない）

　メニュー項目の中央寄せで考えてみる。まずはメニュー項目を網羅してみる。将来追加したいものも含めて。それを画面サイズ320pxのスマホでも表示できるか。ページ遷移クリック領域は画面全体の10%。左右あるので20%。つまりメニュー幅は320px * 0.8 = 256px。アイコンひとつ64pxとすると4つまで。

```
10%                             10%
+--+----------------------------+--+
|ペ|　メニュー項目クリック領域　|ペ|10%
|ー+----------------------------+ー|
|ジ|                            |ジ|
|遷|                            |遷|
|移|                            |移|
|ク|            本文            |ク|
|リ|                            |リ|
|ッ|                            |ッ|
|ク|                            |ク|
|領+----------------------------+領|
|域|　メニュー項目クリック領域　|域|10%
+--+----------------------------+--+
```

### メニュー項目

* index
* setting
* tools
    * bookmark
    * timer
    * marker

#### index

　他の画面へ遷移する。

* 本作品情報（現在閲覧箇所。クリックすると全項目表示画面へ遷移する）
    * 作品名
    * 作品シリーズ
    * 巻,章,ページ数
    * 字数（この巻の総字数）
    * 読了率（この巻の読了率。この作品の読了率。このシリーズの読了率）
    * 商品（書籍、漫画、アニメ（DVD,BD,オンデマンド）、サントラ、ドラマCD、LINEスタンプ、……）
    * 収集率（この作品の収集率。商品の収集率）
    * 売上（数）
    * PV（ダウンロード数）


```
100% 読了率 ○○○字
○章　副題○○○
○巻　作品名○○○
○○○編
○期　シリーズ名
著者名
```

#### setting

　表示設定。

* 全画面ON/OFF
* 表記方向（WritingMode）
    * 縦書き／横書き
* 字／行
* 行間
* 字間
* フォント
    * 種別
        * 明朝／ゴシック
            * ファミリ
    * 太さ
* 色
    * 背景／文字（コントラスト比4.5:1以上）
        * 白／黒
        * 背景は自由`lch`、文字は白黒いずれか自動決定
        * パターン
            * グラデーション
            * 模様
            * アニメーション
            * イラスト
        * 自動変更
            * アルゴリズム
                * 日没時刻になると背景色を白から黒へ

```
[全]　[縦]
|---------| ○字／行
|---------| ○％字行間
|---------| ○％字字間
|---------| ○太さ
フォント
　　本文   [IPAex明朝▼] [明朝／ゴシック／筆書／デザイン▼]
　　見出し [IPAexゴシック▼] カーニング等
　　会話   [...▼]
色
　　[白／黒▼]
　　[]背景 []文字
　　[▼]グラーデーション
　　[▼]模様
　　[▼]イラスト
　　[▼]アニメーション
```

https://tsutawarudesign.com/yomiyasuku1.html
https://tsutawarudesign.com/yomiyasuku2.html
https://tsutawarudesign.com/yomiyasuku3.html
http://www.akibatec.net/wabunfont/category/kointai.html

ゴシック：Noto Sans CJK JP （源ノ角ゴシック）
https://www.google.com/get/noto/#sans-jpan

明朝：Noto serif CJK JP
https://www.google.com/get/noto/#serif-jpan

　和英の書体名対応表。

和|英
--|--
ゴシック|サンセリフ
明朝|セリフ

https://ics.media/entry/14087/

#### tools

* bookmark
* timer
* marker

##### bookmark

* 前回終了時から復元用
* Undo,Redoから復元用
* ユーザ任意

##### timer

* 現在時刻
* 経過時間
* 残り時間（事前に指定した時間・時刻まであと）

##### marker

　本文に印をつけたり、自由に文章やHTMLを挿入する。Markdown入力で。校正、感想、勉強、メモなどに使える。

* マークする箇所
* マーク内容

　どうやってマークする箇所を指定するか。本文のHTML構造を変更することなくマークするのは極めて難しい。方法が思いつかない。先頭から字数カウントする方法が思いつくが、もし途中で本文にミスがあり更新されたら位置がずれる。p要素の位置にしても同じ。もし大幅に加筆されたり削除されたらp要素の位置もずれる。

```
index setting tools
```
```
[index] setting tools
----------------------
100% 読了率 ○○○字
○章　副題○○○
○巻　作品名○○○
○○○編
○期　シリーズ名
著者名
```
```
index [setting] tools
----------------------
[全]　[縦]
|---------| ○字／行
|---------| ○％字行間
|---------| ○％字字間
|---------| ○太さ
フォント
　　本文   [IPAex明朝▼] [明朝／ゴシック／筆書／デザイン▼]
　　見出し [IPAexゴシック▼] カーニング等
　　会話   [...▼]
色
　　[白／黒▼]
　　[]背景 []文字
　　[▼]グラーデーション
　　[▼]模様
　　[▼]イラスト
　　[▼]アニメーション
```
```
index setting [tools]
---------------------
bookmark
  1:  9p
  2: 74p
timer
  ☑ 現在時刻
  ☑ 経過時間
  ☑ 残り時間
  　　☑ 1時間　　☑ 19:00
marker
  1: 12p [マークされた場所の文字列] [追加した文字列]
  2: 24p [マークされた場所の文字列] [追加した文字列]
```
